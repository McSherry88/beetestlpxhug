<!DOCTYPE html>

<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Sample AR</title>
		 <script>
      AFRAME.registerComponent("animate-png", {
        init: function() {
          // load the .pngs
          let loader = new THREE.TextureLoader()
          this.pngArray = []
          this.pngArray.push(loader.load('https://i.imgur.com/wjobVTN.jpg'))
          this.pngArray.push(loader.load('https://i.imgur.com/I7PAB.jpg'))
          this.pngArray.push(loader.load('https://i.imgur.com/HNluPrg.jpg'))

          this.el.addEventListener('loaded', e => {
            let mesh = this.el.getObject3D("mesh")
            this.material = mesh.material

            var i = 0
            this.id = setInterval(e => {
              if (i >= this.pngArray.length) i = 0;
              this.material.map = this.pngArray[i++]
              this.material.needsUpdate = true
            }, 500)
          })
        },
        remove: function() {
          clearInterval(this.id);
          // free the memory
          for (let i = 0; i < this.pngArray.length; i++) {
            this.pngArray[i].dispose();
          }
        }
      })

    </script>
    <a-scene>
      <a-box position="-1 0.5 -3" rotation="0 45 0" animate-png></a-box>

    </head>
	<body style="margin : 0px; overflow: hidden; font-family: Monospace;"><div style='position: fixed; top: 10px; width:100%; text-align: center; z-index: 1;'>
	</div>
		<a-scene embedded arjs='sourceType: webcam; detectionMode: mono_and_matrix; matrixCodeType: 3x3;'>

			<a-assets>
				<img id="sample_image" src="assets/asset.gif" crossorigin="anonymous">
    		</a-assets>

			<a-marker preset='custom' type='pattern' url='20180907580108dD9Ddfe85eff0cc2f8b608fe302f18982cbf0.patt'>

					<!-- FOR GIFS -->
					<!-- <a-entity rotation="-90 0 0" geometry="primitive:plane" material="shader:gif;src:url(20181138140108sMGxF65b152e0f17c33d387c1b33cc0b0be1e.gif);" gif="" transparent="true"></a-entity> -->

					<!-- FOR NON-GIF IMAGES -->
					<!-- <a-image rotation="-90 0 0" src="#sample_image"></a-image> -->

					<!-- FOR TEXT					 -->
					<a-entity rotation="-90 0 0" position="-1 0 0" text-geometry="value: Sample Sample Sample; size: 0.2;"></a-entity>
			</a-marker>

			<a-entity camera></a-entity>
		</a-scene>
	</body>

	<script src="aframe-text-geometry-component.min.js"></script>
	<script src="aframe-gif-shader.js"></script>
</html>
